<polymer-element name="animate-player" attributes="animationLock path devices">

  <template>

    <core-animation duration="{{ (path.length * 1000) / 2 }}" id="animation">

      <template repeat="{{ step, i in path }}">

        <core-animation-keyframe offset="{{ (1 / (path.length - 1)) * i }}">

          <template if="{{ devices.mobile }}">
            <core-animation-prop name="transform" value="{{ step | toTranslate(60) }}">
            </core-animation-prop>
          </template>

          <template if="{{ devices.medium }}">
            <core-animation-prop name="transform" value="{{ step | toTranslate(75) }}">
            </core-animation-prop>
          </template>

          <template if="{{ devices.large }}">
            <core-animation-prop name="transform" value="{{ step | toTranslate(90) }}">
            </core-animation-prop>
          </template>

          <template if="{{ devices.xlarge }}">
            <core-animation-prop name="transform" value="{{ step | toTranslate(105) }}">
            </core-animation-prop>
          </template>

          <template if="{{ devices.xxlarge }}">
            <core-animation-prop name="transform" value="{{ step | toTranslate(120) }}">
            </core-animation-prop>
          </template>

        </core-animation-keyframe>

      </template>

    </core-animation>

  </template>

   <script>

      Polymer('animate-player', {
        ready : function () {
          this.addEventListener('core-animation-start', function(event) {
            this.animationLock = true;
          }.bind(this));
          this.addEventListener('core-animation-end', function(event) {
            this.animationLock = false;
          }.bind(this));
        },
        pathChanged : function () {
          console.log(this.path.length);
          if (this.animationLock === false) {
            this.async(this.play);
          }
        },
        play : function () {
          this.$.animation.play();
        },
        toTranslate : function (value, pixels) {
          var result =
            'translate(' +
            (value[0] * pixels) +
            'px, ' +
            (value[1] * pixels) +
            ')';
          return result;
        }
      });

    </script>

</polymer-element>
